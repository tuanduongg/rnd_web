import{s as V,ac as J,r as l,j as e,aq as Q,ar as w,I as B,as as ee,ae as se,at as x,W as k,Z as H,X as te,S as ae,Y as le,aG as ie,a7 as ne,a6 as U,av as re,am as z,an as D,aw as oe,ap as ce,w as de,ay as ue,aj as he,az as me,a2 as xe,ax as X,aE as ge,aF as fe}from"./index-DBaoacUW.js";import{M as je,C as pe,L as be,T as Ce,t as _,a as O,f as Se,h as ve,b as Ie,c as Te,d as De,e as Ae,g as ye,I as Ne}from"./empty-box-DHr8RTl0.js";const ke=V(J)(({theme:c})=>({"& .MuiDialogContent-root":{padding:c.spacing(2)},"& .MuiDialogActions-root":{padding:c.spacing(1)}})),r={error:!1,msg:""};function ze({open:c,onClose:E,afterSave:v,setSnackBar:u,selected:h,typeModal:n}){l.useState([]);const[f,I]=l.useState(""),[p,o]=l.useState([]),[m,b]=l.useState(""),[i,T]=l.useState(""),[g,t]=l.useState(""),[C,S]=l.useState(r),[F,R]=l.useState(r),[M,P]=l.useState(r),[j,W]=l.useState(r),[A,q]=l.useState(!1),[K,y]=l.useState(!1),N=(s,d)=>{d&&(d=="backdropClick"||d==="escapeKeyDown")||(I(""),b(""),t(""),q(!1),S(r),R(r),P(r),W(r),T(""),E())},Y=async()=>{y(!0);const s=await z.get(D.roleAll);y(!1),(s==null?void 0:s.status)===200&&o(s==null?void 0:s.data)},$=async()=>{var d;y(!0);const s=await z.post(D.findUser,{userId:h==null?void 0:h.userId});if(y(!1),(s==null?void 0:s.status)===200){const a=s==null?void 0:s.data;I(a==null?void 0:a.fullName),b(a==null?void 0:a.userName),q(a==null?void 0:a.isRoot),T((d=a==null?void 0:a.role)==null?void 0:d.roleId)}};l.useEffect(()=>{Y()},[]),l.useEffect(()=>{c&&n==="EDIT"&&h&&$()},[c]);const L=s=>{const{name:d,value:a}=s==null?void 0:s.target;switch(d){case"fullName":C.error&&S(r),I(a);break;case"userName":F.error&&R(r),b(a);break;case"password":M.error&&P(r),t(a);break}},Z=()=>{let s=!1;if(i||(s=!0,W({error:!0,msg:"This field is requird!"})),(f==null?void 0:f.trim())===""&&(s=!0,S({error:!0,msg:"This field is requird!"})),(m==null?void 0:m.trim())===""&&(s=!0,R({error:!0,msg:"This field is requird!"})),(g==null?void 0:g.trim())===""&&n==="ADD"&&(s=!0,P({error:!0,msg:"This field is requird!"})),s===!1){let d=n==="ADD"?D.createUser:D.updateUser;oe({title:n==="ADD"?"Create User":"Update User",message:"Do you want to save changes?",onOK:async()=>{var G;const a=await z.post(d,{userId:h==null?void 0:h.userId,fullName:f,userName:m,role:i,password:g,isRoot:A});(a==null?void 0:a.status)===200?(v(),N(),u({open:!0,message:"Saved changes successful!",type:!0})):u({open:!0,message:((G=a==null?void 0:a.data)==null?void 0:G.message)||"Server Error!",type:!1})}})}};return e.jsxs(e.Fragment,{children:[e.jsxs(ke,{fullScreen:Q,onClose:N,"aria-labelledby":"customized-dialog-title",open:c,children:[e.jsx(w,{sx:{m:0,p:2,fontSize:"18px"},id:"customized-dialog-title",children:"Create New User"}),e.jsx(B,{"aria-label":"close",onClick:N,sx:{position:"absolute",right:8,top:8,color:s=>s.palette.grey[500]},children:e.jsx(ee,{})}),e.jsx(se,{dividers:!0,children:e.jsxs(x,{container:!0,spacing:2,children:[e.jsx(x,{item:!0,xs:12,children:e.jsx(k,{fullWidth:!0,size:"small",children:e.jsx(H,{helperText:C.msg,error:C.error,onChange:L,value:f,name:"fullName",label:"Full Name",size:"small",variant:"outlined"})})}),e.jsx(x,{item:!0,xs:12,children:e.jsx(k,{fullWidth:!0,size:"small",children:e.jsx(H,{disabled:n==="EDIT",helperText:F.msg,error:F.error,onChange:L,name:"userName",value:m,label:"User Name",size:"small",variant:"outlined"})})}),e.jsx(x,{item:!0,xs:12,children:e.jsx(k,{fullWidth:!0,size:"small",children:e.jsx(H,{helperText:M.msg,error:M.error,onChange:L,value:g,name:"password",label:"Password",size:"small",variant:"outlined"})})}),e.jsx(x,{item:!0,xs:12,children:e.jsxs(k,{error:j==null?void 0:j.error,fullWidth:!0,size:"small",children:[e.jsx(te,{id:"demo-simple-select-label",children:"Role"}),e.jsx(ae,{value:i,labelId:"demo-simple-select-label",label:"Role",id:"demo-simple-select",onChange:s=>{j.error&&W(r),T(s.target.value)},children:p==null?void 0:p.map(s=>e.jsx(je,{value:s==null?void 0:s.roleId,children:s==null?void 0:s.roleName},s==null?void 0:s.roleId))}),e.jsx(le,{children:j==null?void 0:j.msg})]})}),e.jsx(x,{item:!0,xs:12,children:e.jsx(ie,{control:e.jsx(pe,{checked:A,value:A,onChange:s=>{q(!A)}}),label:"Root (Have All Role)"})})]})}),e.jsxs(ne,{children:[e.jsx(U,{variant:"text",onClick:N,children:"Close"}),e.jsx(U,{variant:"contained",startIcon:e.jsx(re,{}),autoFocus:!0,onClick:Z,children:"Save changes"})]})]}),e.jsx(be,{open:K})]})}const Fe=()=>{var g;const c=ce(t=>t.auth);l.useState(0),l.useState(10);const[E,v]=l.useState(!1),[u,h]=l.useState([]),[n,f]=l.useState(null),[I,p]=l.useState("ADD");de();const[o,m]=l.useState({open:!1,message:"",type:!0}),b=async()=>{const t=await z.get(D.userAll+"?screen=account");(t==null?void 0:t.status)===200&&h(t==null?void 0:t.data)};l.useEffect(()=>{b()},[]);const i=V(Ce)(({theme:t})=>({[`&.${_.head}`]:{backgroundColor:t.palette.primary.main,color:t.palette.common.white},[`&.${_.body}`]:{fontSize:14}})),T=V(O)(({theme:t})=>({"&:nth-of-type(odd)":{backgroundColor:t.palette.action.hover},"&:last-child td, &:last-child th":{border:0}}));return e.jsxs(e.Fragment,{children:[e.jsxs(x,{container:!0,spacing:2,children:[e.jsx(x,{item:!0,xs:12,children:e.jsx(ue,{contentSX:{padding:"13px !important"},children:e.jsxs(he,{direction:"row",justifyContent:"flex-end",spacing:1,children:[e.jsx(U,{onClick:()=>{p("ADD"),v(!0)},size:"small",startIcon:e.jsx(Se,{}),variant:"contained",children:"New"}),e.jsx(U,{onClick:()=>{p("EDIT"),v(!0)},disabled:!n||((g=c==null?void 0:c.dataUser)==null?void 0:g.userId)===(n==null?void 0:n.userId),size:"small",startIcon:e.jsx(ve,{}),variant:"outlined",children:"Edit"})]})})}),e.jsx(x,{item:!0,xs:12,children:e.jsx(me,{contentSX:{padding:"10px"},children:e.jsx(Ie,{sx:{marginTop:"15px"},component:xe,children:e.jsxs(Te,{sx:{minWidth:700},"aria-label":"customized table",children:[e.jsx(De,{children:e.jsxs(O,{children:[e.jsx(i,{align:"center",children:"#"}),e.jsx(i,{align:"left",children:"Full Name"}),e.jsx(i,{align:"left",children:"User Name"}),e.jsx(i,{align:"center",children:"Role"}),e.jsx(i,{align:"right",children:"Admin"})]})}),e.jsx(Ae,{sx:{".MuiTableRow-root.Mui-selected":{backgroundColor:X.colorSelected},".MuiTableRow-root.Mui-selected:hover":{backgroundColor:X.colorSelected}},children:(u==null?void 0:u.length)>0?u==null?void 0:u.map((t,C)=>{var S;return e.jsxs(T,{selected:(n==null?void 0:n.userId)===(t==null?void 0:t.userId),onClick:()=>f(t),children:[e.jsx(i,{align:"center",children:C+1}),e.jsx(i,{align:"left",component:"th",scope:"row",children:t==null?void 0:t.fullName}),e.jsx(i,{align:"left",children:t==null?void 0:t.userName}),e.jsx(i,{align:"center",children:(S=t==null?void 0:t.role)==null?void 0:S.roleName}),e.jsx(i,{align:"right",children:(t==null?void 0:t.isRoot)&&e.jsx(ye,{})})]},C)}):e.jsx(O,{sx:{textAlign:"center"},children:e.jsxs(i,{colSpan:10,align:"center",children:[e.jsx("img",{src:Ne,width:70,height:70,alt:"image"}),e.jsx("div",{children:"NO DATA"})]})})})]})})})})]}),e.jsx(ge,{autoHideDuration:6e3,anchorOrigin:{vertical:"bottom",horizontal:"right"},open:o==null?void 0:o.open,onClose:()=>{m({open:!1,message:""})},children:e.jsx(fe,{onClose:()=>{m({open:!1,message:""})},severity:o!=null&&o.type?"success":"error",variant:"filled",sx:{width:"100%"},children:o==null?void 0:o.message})}),e.jsx(ze,{typeModal:I,selected:n,setSnackBar:m,afterSave:()=>{b()},open:E,onClose:()=>{v(!1)}})]})};export{Fe as default};
